<!DOCTYPE html>
<html class="no-js" lang="en-US">

	<head>

		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		

		<title>How WooCommerce handles object data</title>
<meta name="robots" content="max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<link rel="dns-prefetch" href="//www.googletagmanager.com">
<link rel="dns-prefetch" href="//s.w.org">

<link rel="stylesheet" id="wp-block-library-css" href="https://juagonala.com/wp-includes/css/dist/block-library/style.min.css" media="all">
<style id="global-styles-inline-css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--accent: #366ee7;--wp--preset--color--primary: #000000;--wp--preset--color--secondary: #6d6d6d;--wp--preset--color--subtle-background: #d8d8d8;--wp--preset--color--background: #fcfcfc;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 18px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 26.25px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 21px;--wp--preset--font-size--larger: 32px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel="stylesheet" id="twentytwenty-style-css" href="https://juagonala.com/wp-content/themes/twentytwenty/style.css" media="all">
<style id="twentytwenty-style-inline-css">
.color-accent,.color-accent-hover:hover,.color-accent-hover:focus,:root .has-accent-color,.has-drop-cap:not(:focus):first-letter,.wp-block-button.is-style-outline,a { color: #366ee7; }blockquote,.border-color-accent,.border-color-accent-hover:hover,.border-color-accent-hover:focus { border-color: #366ee7; }button,.button,.faux-button,.wp-block-button__link,.wp-block-file .wp-block-file__button,input[type="button"],input[type="reset"],input[type="submit"],.bg-accent,.bg-accent-hover:hover,.bg-accent-hover:focus,:root .has-accent-background-color,.comment-reply-link { background-color: #366ee7; }.fill-children-accent,.fill-children-accent * { fill: #366ee7; }:root .has-background-color,button,.button,.faux-button,.wp-block-button__link,.wp-block-file__button,input[type="button"],input[type="reset"],input[type="submit"],.wp-block-button,.comment-reply-link,.has-background.has-primary-background-color:not(.has-text-color),.has-background.has-primary-background-color *:not(.has-text-color),.has-background.has-accent-background-color:not(.has-text-color),.has-background.has-accent-background-color *:not(.has-text-color) { color: #fcfcfc; }:root .has-background-background-color { background-color: #fcfcfc; }body,.entry-title a,:root .has-primary-color { color: #000000; }:root .has-primary-background-color { background-color: #000000; }cite,figcaption,.wp-caption-text,.post-meta,.entry-content .wp-block-archives li,.entry-content .wp-block-categories li,.entry-content .wp-block-latest-posts li,.wp-block-latest-comments__comment-date,.wp-block-latest-posts__post-date,.wp-block-embed figcaption,.wp-block-image figcaption,.wp-block-pullquote cite,.comment-metadata,.comment-respond .comment-notes,.comment-respond .logged-in-as,.pagination .dots,.entry-content hr:not(.has-background),hr.styled-separator,:root .has-secondary-color { color: #6d6d6d; }:root .has-secondary-background-color { background-color: #6d6d6d; }pre,fieldset,input,textarea,table,table *,hr { border-color: #d8d8d8; }caption,code,code,kbd,samp,.wp-block-table.is-style-stripes tbody tr:nth-child(odd),:root .has-subtle-background-background-color { background-color: #d8d8d8; }.wp-block-table.is-style-stripes { border-bottom-color: #d8d8d8; }.wp-block-latest-posts.is-grid li { border-top-color: #d8d8d8; }:root .has-subtle-background-color { color: #d8d8d8; }body:not(.overlay-header) .primary-menu > li > a,body:not(.overlay-header) .primary-menu > li > .icon,.modal-menu a,.footer-menu a, .footer-widgets a,#site-footer .wp-block-button.is-style-outline,.wp-block-pullquote:before,.singular:not(.overlay-header) .entry-header a,.archive-header a,.header-footer-group .color-accent,.header-footer-group .color-accent-hover:hover { color: #366ee7; }.social-icons a,#site-footer button:not(.toggle),#site-footer .button,#site-footer .faux-button,#site-footer .wp-block-button__link,#site-footer .wp-block-file__button,#site-footer input[type="button"],#site-footer input[type="reset"],#site-footer input[type="submit"] { background-color: #366ee7; }.social-icons a,body:not(.overlay-header) .primary-menu ul,.header-footer-group button,.header-footer-group .button,.header-footer-group .faux-button,.header-footer-group .wp-block-button:not(.is-style-outline) .wp-block-button__link,.header-footer-group .wp-block-file__button,.header-footer-group input[type="button"],.header-footer-group input[type="reset"],.header-footer-group input[type="submit"] { color: #fcfcfc; }#site-header,.footer-nav-widgets-wrapper,#site-footer,.menu-modal,.menu-modal-inner,.search-modal-inner,.archive-header,.singular .entry-header,.singular .featured-media:before,.wp-block-pullquote:before { background-color: #fcfcfc; }.header-footer-group,body:not(.overlay-header) #site-header .toggle,.menu-modal .toggle { color: #000000; }body:not(.overlay-header) .primary-menu ul { background-color: #000000; }body:not(.overlay-header) .primary-menu > li > ul:after { border-bottom-color: #000000; }body:not(.overlay-header) .primary-menu ul ul:after { border-left-color: #000000; }.site-description,body:not(.overlay-header) .toggle-inner .toggle-text,.widget .post-date,.widget .rss-date,.widget_archive li,.widget_categories li,.widget cite,.widget_pages li,.widget_meta li,.widget_nav_menu li,.powered-by-wordpress,.to-the-top,.singular .entry-header .post-meta,.singular:not(.overlay-header) .entry-header .post-meta a { color: #6d6d6d; }.header-footer-group pre,.header-footer-group fieldset,.header-footer-group input,.header-footer-group textarea,.header-footer-group table,.header-footer-group table *,.footer-nav-widgets-wrapper,#site-footer,.menu-modal nav *,.footer-widgets-outer-wrapper,.footer-top { border-color: #d8d8d8; }.header-footer-group table caption,body:not(.overlay-header) .header-inner .toggle-wrapper::before { background-color: #d8d8d8; }
</style>
<link rel="stylesheet" id="twentytwenty-print-style-css" href="https://juagonala.com/wp-content/themes/twentytwenty/print.css" media="print">
<link rel="stylesheet" id="juagonala-style-css" href="https://juagonala.com/wp-content/plugins/juagonala-snippets/assets/css/style.css" media="all">
<script src="https://juagonala.com/wp-content/themes/twentytwenty/assets/js/index.js" id="twentytwenty-js-js" async></script>


<script src="https://www.googletagmanager.com/gtag/js?id=UA-170106444-1" id="google_gtagjs-js" async></script>
<script id="google_gtagjs-js-after">
window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}
gtag('set', 'linker', {"domains":["juagonala.com"]} );
gtag("js", new Date());
gtag("set", "developer_id.dZTNiMT", true);
gtag("config", "UA-170106444-1", {"anonymize_ip":true});
</script>



<meta name="generator" content="WordPress 6.0">




<meta name="generator" content="Site Kit by Google 1.75.0">	<script>document.documentElement.className = document.documentElement.className.replace( 'no-js', 'js' );</script>
	<meta name="description" content="Discover how WooCommerce decouples the data layer from the rest of the code in its different types of objects like products, orders, coupons, etc. by making use of the class WC_Data and the data store classes.">
<meta property="og:title" content="How WooCommerce handles object data">
<meta property="og:type" content="article">
<meta property="og:description" content="Discover how WooCommerce decouples the data layer from the rest of the code in its different types of objects like products, orders, coupons, etc. by making use of the class WC_Data and the data store classes.">
<meta property="og:url" content="https://juagonala.com/how-woocommerce-handles-object-data/">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Juan José González">
<meta property="article:published_time" content="2021-09-24T21:00:28+00:00">
<meta property="article:modified_time" content="2021-09-24T21:00:29+00:00">
<meta property="og:updated_time" content="2021-09-24T21:00:29+00:00">
<meta property="article:section" content="Coding">
<meta property="article:tag" content="data-stores">
<meta property="article:tag" content="wc-data">
<meta property="article:tag" content="woocommerce">
<meta property="article:author" content="Juan José">
<meta name="twitter:card" content="summary_large_image">
<style id="custom-background-css">
body.custom-background { background-color: #fcfcfc; }
</style>
	
	</head>

	<body class="post-template-default single single-post postid-398 single-format-standard custom-background wp-embed-responsive singular missing-post-thumbnail has-single-pagination showing-comments show-avatars footer-top-visible reduced-spacing">

		<a class="skip-link screen-reader-text" href="#site-content">Skip to the content</a><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-dark-grayscale"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 0.49803921568627"></fefuncr><fefuncg type="table" tablevalues="0 0.49803921568627"></fefuncg><fefuncb type="table" tablevalues="0 0.49803921568627"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-grayscale"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 1"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0 1"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-yellow"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.54901960784314 0.98823529411765"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0.71764705882353 0.25490196078431"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-red"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 1"></fefuncr><fefuncg type="table" tablevalues="0 0.27843137254902"></fefuncg><fefuncb type="table" tablevalues="0.5921568627451 0.27843137254902"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-midnight"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0 0"></fefuncr><fefuncg type="table" tablevalues="0 0.64705882352941"></fefuncg><fefuncb type="table" tablevalues="0 1"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-magenta-yellow"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.78039215686275 1"></fefuncr><fefuncg type="table" tablevalues="0 0.94901960784314"></fefuncg><fefuncb type="table" tablevalues="0.35294117647059 0.47058823529412"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-green"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.65098039215686 0.40392156862745"></fefuncr><fefuncg type="table" tablevalues="0 1"></fefuncg><fefuncb type="table" tablevalues="0.44705882352941 0.4"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-orange"><fecolormatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "></fecolormatrix><fecomponenttransfer color-interpolation-filters="sRGB"><fefuncr type="table" tablevalues="0.098039215686275 1"></fefuncr><fefuncg type="table" tablevalues="0 0.66274509803922"></fefuncg><fefuncb type="table" tablevalues="0.84705882352941 0.41960784313725"></fefuncb><fefunca type="table" tablevalues="1 1"></fefunca></fecomponenttransfer><fecomposite in2="SourceGraphic" operator="in"></fecomposite></filter></defs></svg>
		<header id="site-header" class="header-footer-group">

			<div class="header-inner section-inner">

				<div class="header-titles-wrapper">

					
					<div class="header-titles">

						<div class="site-title faux-heading"><a href="https://juagonala.com/">Juan José González</a></div>
					</div>

					<button class="toggle nav-toggle mobile-nav-toggle" data-toggle-target=".menu-modal" data-toggle-body-class="showing-menu-modal" aria-expanded="false" data-set-focus=".close-nav-toggle">
						<span class="toggle-inner">
							<span class="toggle-icon">
								<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="26" height="7" viewbox="0 0 26 7"><path fill-rule="evenodd" d="M332.5,45 C330.567003,45 329,43.4329966 329,41.5 C329,39.5670034 330.567003,38 332.5,38 C334.432997,38 336,39.5670034 336,41.5 C336,43.4329966 334.432997,45 332.5,45 Z M342,45 C340.067003,45 338.5,43.4329966 338.5,41.5 C338.5,39.5670034 340.067003,38 342,38 C343.932997,38 345.5,39.5670034 345.5,41.5 C345.5,43.4329966 343.932997,45 342,45 Z M351.5,45 C349.567003,45 348,43.4329966 348,41.5 C348,39.5670034 349.567003,38 351.5,38 C353.432997,38 355,39.5670034 355,41.5 C355,43.4329966 353.432997,45 351.5,45 Z" transform="translate(-329 -38)"></path></svg>							</span>
							<span class="toggle-text">Menu</span>
						</span>
					</button>

				</div>

				<div class="header-navigation-wrapper">

					
							<nav class="primary-menu-wrapper" aria-label="Horizontal">

								<ul class="primary-menu reset-list-style">

								<li class="page_item page-item-32"><a href="https://juagonala.com/about/">About</a></li>

								</ul>

							</nav>

						
				</div>

			</div>

			
		</header>

		
<div class="menu-modal cover-modal header-footer-group" data-modal-target-string=".menu-modal">

	<div class="menu-modal-inner modal-inner">

		<div class="menu-wrapper section-inner">

			<div class="menu-top">

				<button class="toggle close-nav-toggle fill-children-current-color" data-toggle-target=".menu-modal" data-toggle-body-class="showing-menu-modal" data-set-focus=".menu-modal">
					<span class="toggle-text">Close Menu</span>
					<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 16 16"><polygon fill="" fill-rule="evenodd" points="6.852 7.649 .399 1.195 1.445 .149 7.899 6.602 14.352 .149 15.399 1.195 8.945 7.649 15.399 14.102 14.352 15.149 7.899 8.695 1.445 15.149 .399 14.102"></polygon></svg>				</button>

				
					<nav class="mobile-menu" aria-label="Mobile">

						<ul class="modal-menu reset-list-style">

						<li id="menu-item-44" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-44"><div class="ancestor-wrapper"><a href="https://juagonala.com/">Home</a></div></li>
<li id="menu-item-45" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-45"><div class="ancestor-wrapper"><a href="https://juagonala.com/about/">About</a></div></li>

						</ul>

					</nav>

					
			</div>

			<div class="menu-bottom">

				
					<nav aria-label="Expanded Social links">
						<ul class="social-menu reset-list-style social-icons fill-children-current-color">

							<li id="menu-item-144" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-144"><a href="https://linkedin.com/in/juan-jose-gonzalez-alanis"><span class="screen-reader-text">LinkedIn</span><svg class="svg-icon" aria-hidden="true" role="img" focusable="false" width="24" height="24" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.7,3H4.3C3.582,3,3,3.582,3,4.3v15.4C3,20.418,3.582,21,4.3,21h15.4c0.718,0,1.3-0.582,1.3-1.3V4.3 C21,3.582,20.418,3,19.7,3z M8.339,18.338H5.667v-8.59h2.672V18.338z M7.004,8.574c-0.857,0-1.549-0.694-1.549-1.548 c0-0.855,0.691-1.548,1.549-1.548c0.854,0,1.547,0.694,1.547,1.548C8.551,7.881,7.858,8.574,7.004,8.574z M18.339,18.338h-2.669 v-4.177c0-0.996-0.017-2.278-1.387-2.278c-1.389,0-1.601,1.086-1.601,2.206v4.249h-2.667v-8.59h2.559v1.174h0.037 c0.356-0.675,1.227-1.387,2.526-1.387c2.703,0,3.203,1.779,3.203,4.092V18.338z"></path></svg></a></li>
<li id="menu-item-143" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-143"><a href="https://github.com/juagonala"><span class="screen-reader-text">GitHub</span><svg class="svg-icon" aria-hidden="true" role="img" focusable="false" width="24" height="24" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12,2C6.477,2,2,6.477,2,12c0,4.419,2.865,8.166,6.839,9.489c0.5,0.09,0.682-0.218,0.682-0.484 c0-0.236-0.009-0.866-0.014-1.699c-2.782,0.602-3.369-1.34-3.369-1.34c-0.455-1.157-1.11-1.465-1.11-1.465 c-0.909-0.62,0.069-0.608,0.069-0.608c1.004,0.071,1.532,1.03,1.532,1.03c0.891,1.529,2.341,1.089,2.91,0.833 c0.091-0.647,0.349-1.086,0.635-1.337c-2.22-0.251-4.555-1.111-4.555-4.943c0-1.091,0.39-1.984,1.03-2.682 C6.546,8.54,6.202,7.524,6.746,6.148c0,0,0.84-0.269,2.75,1.025C10.295,6.95,11.15,6.84,12,6.836 c0.85,0.004,1.705,0.114,2.504,0.336c1.909-1.294,2.748-1.025,2.748-1.025c0.546,1.376,0.202,2.394,0.1,2.646 c0.64,0.699,1.026,1.591,1.026,2.682c0,3.841-2.337,4.687-4.565,4.935c0.359,0.307,0.679,0.917,0.679,1.852 c0,1.335-0.012,2.415-0.012,2.741c0,0.269,0.18,0.579,0.688,0.481C19.138,20.161,22,16.416,22,12C22,6.477,17.523,2,12,2z"></path></svg></a></li>

						</ul>
					</nav>

				
			</div>

		</div>

	</div>

</div>

<main id="site-content">

	
<article class="post-398 post type-post status-publish format-standard hentry category-coding tag-data-stores tag-wc-data tag-woocommerce" id="post-398">

	
<header class="entry-header has-text-align-center header-footer-group">

	<div class="entry-header-inner section-inner medium">

		
			<div class="entry-categories">
				<span class="screen-reader-text">Categories</span>
				<div class="entry-categories-inner">
					<a href="https://juagonala.com/category/coding/" rel="category tag">Coding</a>				</div>
			</div>

			<h1 class="entry-title">How WooCommerce handles object data</h1>
		<div class="post-meta-wrapper post-meta-single post-meta-single-top">

			<ul class="post-meta">

									<li class="post-author meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">Post author</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="20" viewbox="0 0 18 20"><path fill="" d="M18,19 C18,19.5522847 17.5522847,20 17,20 C16.4477153,20 16,19.5522847 16,19 L16,17 C16,15.3431458 14.6568542,14 13,14 L5,14 C3.34314575,14 2,15.3431458 2,17 L2,19 C2,19.5522847 1.55228475,20 1,20 C0.44771525,20 0,19.5522847 0,19 L0,17 C0,14.2385763 2.23857625,12 5,12 L13,12 C15.7614237,12 18,14.2385763 18,17 L18,19 Z M9,10 C6.23857625,10 4,7.76142375 4,5 C4,2.23857625 6.23857625,0 9,0 C11.7614237,0 14,2.23857625 14,5 C14,7.76142375 11.7614237,10 9,10 Z M9,8 C10.6568542,8 12,6.65685425 12,5 C12,3.34314575 10.6568542,2 9,2 C7.34314575,2 6,3.34314575 6,5 C6,6.65685425 7.34314575,8 9,8 Z"></path></svg>						</span>
						<span class="meta-text">
							By <a href="#">Juan José</a>						</span>
					</li>
										<li class="post-date meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">Post date</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewbox="0 0 18 19"><path fill="" d="M4.60069444,4.09375 L3.25,4.09375 C2.47334957,4.09375 1.84375,4.72334957 1.84375,5.5 L1.84375,7.26736111 L16.15625,7.26736111 L16.15625,5.5 C16.15625,4.72334957 15.5266504,4.09375 14.75,4.09375 L13.3993056,4.09375 L13.3993056,4.55555556 C13.3993056,5.02154581 13.0215458,5.39930556 12.5555556,5.39930556 C12.0895653,5.39930556 11.7118056,5.02154581 11.7118056,4.55555556 L11.7118056,4.09375 L6.28819444,4.09375 L6.28819444,4.55555556 C6.28819444,5.02154581 5.9104347,5.39930556 5.44444444,5.39930556 C4.97845419,5.39930556 4.60069444,5.02154581 4.60069444,4.55555556 L4.60069444,4.09375 Z M6.28819444,2.40625 L11.7118056,2.40625 L11.7118056,1 C11.7118056,0.534009742 12.0895653,0.15625 12.5555556,0.15625 C13.0215458,0.15625 13.3993056,0.534009742 13.3993056,1 L13.3993056,2.40625 L14.75,2.40625 C16.4586309,2.40625 17.84375,3.79136906 17.84375,5.5 L17.84375,15.875 C17.84375,17.5836309 16.4586309,18.96875 14.75,18.96875 L3.25,18.96875 C1.54136906,18.96875 0.15625,17.5836309 0.15625,15.875 L0.15625,5.5 C0.15625,3.79136906 1.54136906,2.40625 3.25,2.40625 L4.60069444,2.40625 L4.60069444,1 C4.60069444,0.534009742 4.97845419,0.15625 5.44444444,0.15625 C5.9104347,0.15625 6.28819444,0.534009742 6.28819444,1 L6.28819444,2.40625 Z M1.84375,8.95486111 L1.84375,15.875 C1.84375,16.6516504 2.47334957,17.28125 3.25,17.28125 L14.75,17.28125 C15.5266504,17.28125 16.15625,16.6516504 16.15625,15.875 L16.15625,8.95486111 L1.84375,8.95486111 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="https://juagonala.com/how-woocommerce-handles-object-data/">September 24, 2021</a>
						</span>
					</li>
					
			</ul>

		</div>

		
	</div>

</header>

	<div class="post-inner thin ">

		<div class="entry-content">

			
<p>Previously on “<a href="https://juagonala.com/stop-using-arrays-for-everything/" data-type="post" data-id="314">Stop using arrays for everything</a>“, I exposed that an array wasn’t always the best way to accomplish a task and I gave an example in which an object was a better solution for that case.  </p>



<p>Today, I’d like to illustrate how powerful the OOP can be and the benefits of using objects. To do so, I’ll use as an example one of the most popular WordPress plugins and the biggest e-commerce platform at this moment. I’m talking about <a href="https://woocommerce.com/" data-type="URL" data-id="https://woocommerce.com/" target="_blank" rel="noreferrer noopener">WooCommerce</a> and how this one handles the data of its different kinds of objects like products, orders, coupons, etc.</p>



<span id="more-398"></span>



<p>These e-commerce elements are represented by entity classes. E.g. The orders use the class <code>WC_Order</code>. The coupons, the class <code>WC_Coupon</code>, and so on.</p>



<p>All these classes have something in common, they extend the class <code>WC_Data</code>. And this class is, <meta charset="utf-8">in my opinion, one of these hidden jewels included in the WooCommerce core that is worth a look at it.</p>



<p>You might be thinking: “I’m not working with WooCommerce, so this post is not for me”, but trust me, thanks to this class, we’re going to discover a good way for abstracting the data layer from the rest of the code. And what it’s better, we’ll be able to create our own reusable and well-tested class for handling the object data in our WordPress plugins. So, let’s start:</p>



<h2>The class WC_Data</h2>



<p> <a href="https://github.com/woocommerce/woocommerce/blob/trunk/includes/abstracts/abstract-wc-data.php" data-type="URL" data-id="https://github.com/woocommerce/woocommerce/blob/trunk/includes/abstracts/abstract-wc-data.php" target="_blank" rel="noreferrer noopener">This class</a>, as its own description says:</p>



<blockquote class="wp-block-quote"><p><em>Handles generic data interaction which is implemented by the different data store classes.</em></p><cite>WC_Data class description.</cite></blockquote>



<p>There are a few concepts here like <em>data interaction</em> and <em>data store classes</em> that are quite abstract, so instead of giving you a definition, which you can find anywhere on the Internet, we’re going to see them with an example.</p>



<p>When you create an object that makes use of this class, you can do things like this:</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: php; title: ; notranslate" title="">
// This class extends WC_Data.
$product = new Product();

// Set some product properties.
$product-&gt;set_title( 'My awesome product' );
$product-&gt;set_price( '20' );

// The product is created in the database.
$product_id = $product-&gt;save();

// Read the product from the database.
$product_2 = new Product( $product_id );

$product_2-&gt;get_title(); // 'My awesome product'.
$product_2-&gt;set_price( '25' ); // Update the price.

// The product is updated in the database.
$product-&gt;save();

// The product is deleted from the database.
$product-&gt;delete();

</pre></div>


<p>Pretty cool, right? Moreover, the product object keeps track of the changes applied to it since it was created/fetched from the database. So when it’s saved, only the changes are updated, not the whole object, which makes the save process quite efficient.</p>



<p>But, how is it possible all of this with just a single class? Well, because the <code>WC_Data</code> class doesn’t work alone, it receives the help of another class, a “<strong>Data_Store</strong>” class.</p>



<p>In our previous example, we found two different types of methods, some of them for interacting with the object data (<code>getters</code> and <code>setters</code>), and others for the CRUDs operations (<code>save</code>, <code>delete</code>, etc.).</p>



<p>The getters and setters methods are handled directly by the class <code>WC_Data</code>. Meanwhile, the CRUD’s operations are done by the data store class.</p>



<p>To explain how these classes work together, we are going to create our own classes, which will be a very simplified version of the originals.</p>



<p>Let’s start by creating our own <strong>Data</strong> class:</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: php; title: ; notranslate" title="">
abstract class Data {

    /**
	 * Object data in pairs (name + value).
	 *
	 * @var array
	 */
    protected $data = array();

    /**
	 * Data changes for this object.
	 *
	 * @var array
	 */
	protected $changes = array();


    /**
	 * Gets the value of the specified property.
     *
     * @param string $prop The property name.
     * @return mixed
     */
    protected function get_prop( $pop ) {
        $value = null;

        if ( array_key_exists( $prop, $this-&gt;data ) ) {
            $value = ( array_key_exists( $prop, $this-&gt;changes ) ? $this-&gt;changes[ $prop ] : $this-&gt;data[ $prop ] );
        }

        return $value;
    }
 
    /**
	 * Sets the value of the specified property.
     *
     * @param string $prop  The property name.
     * @param mixed  $value The value to set.
     */
    protected function set_prop( $prop, $value ) {
        if ( ! array_key_exists( $prop, $this-&gt;data ) ) {
            return;
        }

        if ( $value !== $this-&gt;data[ $prop ] || array_key_exists( $prop, $this-&gt;changes ) ) {
		    $this-&gt;changes[ $prop ] = $value;
	    }
    }

    /**
	 * Gets the data changes.
	 *
	 * @return array
	 */
	public function get_changes() {
		return $this-&gt;changes;
	}

    /**
	 * Merges changes with data and clear.
	 */
	public function apply_changes() {
		$this-&gt;data    = array_replace( $this-&gt;data, $this-&gt;changes ); // @codingStandardsIgnoreLine
		$this-&gt;changes = array();
	}
}
</pre></div>


<p>The class is pretty simple, just two properties, one for storing the object data and another for the changes. The data and the changes are represented by an array of pairs name + value. Each entry represents a property of the object that can be fetched and/or modified by the methods <code>get_prop()</code> and <code>set_prop()</code>.</p>



<p>Some considerations about this class:</p>



<ul><li>The methods <code>get_prop()</code> and <code>set_prop()</code> only work with properties defined in <code>$data</code>.</li><li>The method <code>set_prop()</code> sets the value in <code>$changes</code>, not in <code>$data</code>. This way, we keep track of the changes applied to the object. The changes won’t be merged with <code>$data</code> until the object is saved, when we’ll call the method <code>apply_changes()</code>.</li><li>Finally, the methods <code>get_prop()</code> and <code>set_prop()</code> are protected. That means they cannot be used freely by the users.</li></ul>



<p>Now, let’s make use of this class in a hypothetical <strong>Product</strong> class:</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: php; title: ; notranslate" title="">
class Product extends Data {

    /**
     * Product data.
     *
     * @var array
     */
    protected $data = array(
        'name'  =&gt; '',
        'price' =&gt; '',
    );

    /**
     * Gets the product name.
	 *
	 * @return string
	 */
    public function get_name() {
        return $this-&gt;get_prop( 'name' );
    }

    /**
	 * Gets the product price.
	 *
	 * @return string
	 */
    public function get_price() {
        return $this-&gt;get_prop( 'price' );
    }

    /**
	 * Sets the product name.
	 *
	 * @param string $name Product name.
	 */
    public function set_name( $name ) {
        $this-&gt;set_prop( 'name', $name );
    }

    /**
	 * Sets the product price.
	 *
	 * @param string $price Product price.
	 */
    public function set_price( $price ) {
        $this-&gt;set_prop( 'price', floatval( $price ) );
    }
}
</pre></div>


<p>Our <strong>Product</strong> class has two properties, name and price, defined in <code>$data</code> with a default value. Each property has its own getter and setter methods.</p>



<p>Although this code could be quite verbose, it allows us to define which data properties we expose (make public) and which don’t. We could even define only read/write properties or properties that are not public at all. That’s why the methods <code>get_prop()</code> and <code>set_prop()</code> are <code>protected</code>. We don’t want to expose all <code>$data</code> properties by default.</p>



<p>By now, we have solved how to access and modify the different properties of an object, but we haven’t finished yet. We still have to implement the CRUD’s operations.</p>



<h2>CRUD’s operations</h2>



<p>The acronym “<strong>CRUD</strong>” is just the combination of the first letter of the words “<strong>C</strong>reate”, “<strong>R</strong>ead”, “<strong>U</strong>pdate”, and “<strong>D</strong>elete”, which are the operations we are going to implement in our <strong>Data</strong> class.</p>



<p><strong>Note:</strong> To not make the following code block too long and keep the focus on the new functionality, I’m going to omit all the code implemented in this class previously.</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: php; title: ; notranslate" title="">
abstract class Data {

    // Assume all the code implemented previously.

    /**
	 * Object ID.
	 *
	 * @var int
	 */
    protected $id = 0;

    /**
	 * A reference to the data store.
	 *
	 * @var Data_Store
	 */
	protected $data_store;


    /**
	 * Gets the object ID.
     *
     * @return int
     */
    public function get_id() {
        return $this-&gt;id;
    }

    /**
	 * Sets the object ID.
     *
     * @param int $id Object ID.
     */
    public function set_id( $id ) {
        $this-&gt;id = absint( $id );
    }
 
    /**
	 * Creates or updates the object.      
     *
     * @return int
     */
    public function save() {
        if ( ! $this-&gt;data_store ) {
            return $this-&gt;get_id();
        }

        if ( $this-&gt;get_id() ) {
		    $this-&gt;data_store-&gt;update( $this );
	    } else {
            $this-&gt;data_store-&gt;create( $this );
        }

        return $this-&gt;get_id();
    }

    /**
     * Deletes the object.
     *
     * @return bool
     */
    public function delete() {
        if ( ! $this-&gt;data_store ) {
            return false;
        }

        return $this-&gt;data_store-&gt;delete( $this );
    }
}
</pre></div>


<p>Reading the code carefully, we see the class has two new properties, <code>$id</code> and <code>$data_store</code>. The first one is self-explanatory, as we are going to create multiple instances of this object, we need a way to identify these objects.</p>



<p>The <code>$data_store</code> property is not so intuitive. By now, I can tell you that it will be an instance of a <strong>Data_Store</strong> class. This class will be in charge of persisting and recovering the object data, so it will include the logic of the CRUD’s operations. </p>



<p>As you can see in the methods <code>save()</code> and <code>delete()</code>, the logic of the operations is delegated to methods of the <strong>Data_Store</strong> class. This way of structuring the code is known as the <a rel="noreferrer noopener" href="https://phptherightway.com/pages/Design-Patterns.html#strategy" data-type="URL" data-id="https://phptherightway.com/pages/Design-Patterns.html#strategy" target="_blank">Strategy Pattern</a>, and it allows us to decouple the code of the CRUD’s operations from the <strong>Data</strong> class.</p>



<h2>The data store classes</h2>



<p>In WooCommerce, each type of object (product, order, etc.) has its own data store class (a concrete class in the strategy pattern), and the way they persist and fetch the data can be totally different.</p>



<p>The best part of using data store classes is that you could change the implementation of the CRUD’s operations of an object just by replacing its data store class and without the need of modifying the rest of the code. This is especially useful when you need to migrate the data from one storage system to another.</p>



<p><strong>E.g:</strong> Currently, WooCommerce stores the product objects in the WordPress “<strong>posts</strong>” and “<strong>postmetas</strong>” tables. If anytime the development team would like to create specific (and more optimized) tables for this kind of content, they only would need to modify the <a rel="noreferrer noopener" href="https://github.com/woocommerce/woocommerce/blob/trunk/includes/data-stores/class-wc-product-data-store-cpt.php" data-type="URL" data-id="https://github.com/woocommerce/woocommerce/blob/trunk/includes/data-stores/class-wc-product-data-store-cpt.php" target="_blank">WC_Product_Data_Store_CPT</a> class and everything would continue working like before. You wouldn’t notice the change unless you interacted with the product data directly in the database (Don’t do it).</p>



<p>This interchangeability is only possible if the data store classes use the same methods for the CRUD’s operations, so the next step is to create an interface as a contract for all of them.</p>



<p>The following fragment of code is a simplified version of the WooCommerce interface <a rel="noreferrer noopener" href="https://github.com/woocommerce/woocommerce/blob/trunk/includes/interfaces/class-wc-object-data-store-interface.php" data-type="URL" data-id="https://github.com/woocommerce/woocommerce/blob/trunk/includes/interfaces/class-wc-object-data-store-interface.php" target="_blank">WC_Object_Data_Store_Interface</a>.</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: php; title: ; notranslate" title="">
interface Data_Store {

    /**
	 * Creates a Data based object.
	 *
	 * @param Data $object Data object.
	 */
	public function create( &amp;$object );

	/**
	 * Reads a Data based object.
	 *
	 * @param Data $object Data object.
	 */
	public function read( &amp;$object );

	/**
	 * Updates a Data based object.
	 *
	 * @param Data $object Data object.
	 */
	public function update( &amp;$object );

	/**
	 * Deletes a Data based object.
	 *
	 * @param Data $object Data object.
	 * @return bool
	 */
	public function delete( &amp;$object );
}
</pre></div>


<p>Notice how all the methods receive an instance (by reference) of the object they will interact with. Any change applied to this object will be reflected immediately in the original.</p>



<p>Now, it’s time to create a specific data store class for our <strong>Product</strong> class by making use of this interface. In our implementation, we are going to store the data in the WordPress tables “<strong>posts</strong>” and “<strong>postmeta</strong>“.</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: php; title: ; notranslate" title="">
class Product_Data_Store implements Data_Store {

    /**
	 * Creates a new product.
	 *
	 * @param Product $product Product object.
	 */
	 public function create( &amp;$product ) {
         $data = array(
             'post_type'    =&gt; 'product',
             'post_title'   =&gt; $product-&gt;get_name(),
             'post_content' =&gt; '',
         );

         $product_id = wp_insert_post( $data, true );

         if ( $product_id &amp;&amp; ! is_wp_error( $product_id ) ) {
             $product-&gt;set_id( $product_id );

             // Save the rest of properties as metadata.
             add_post_meta( $product_id, 'price', $product-&gt;get_price() );

             $product-&gt;apply_changes();
         }
     }
}
</pre></div>


<p>As you can see, the method <code>create()</code> receives a <code>Product</code> object and stores it into the database by creating a new post with the function <code>wp_insert_post()</code>. The “<strong>posts</strong>” table has a restricted set of columns like ‘post_title’, ‘post_content’, etc., so the rest of the product data needs to be stored as metadata.</p>



<p>Once the post is inserted, we update the product ID with the returned post ID. Finally, we apply the changes to the object data and reset the changes. This way, our product object is ready to log new changes in its data.</p>



<p>Let’s continue with the <code>read()</code> method:</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: php; title: ; notranslate" title="">
/**
 * Reads a product.
 *
 * @param Product $product Product object.
 */
public function read( &amp;$product ) {
    $product_id = $product-&gt;get_id();
    $post       = ( $product_id ? get_post( $product_id ) : null );

    if ( ! $post || 'product' !== $post-&gt;post_type ) {   
        throw new Exception( 'Invalid product.' );
    }

    $product-&gt;set_name( $post-&gt;post_title );
    $product-&gt;set_price( get_post_meta( $post_id, 'price', true );
}
</pre></div>


<p>This method is quite simple, just fetches the post object with the function <code>get_post()</code> and checks the returned object is a product. Otherwise, it throws an Exception. Finally, it populates the product data by calling the setter methods.</p>



<p>Now, the <code>update()</code> method:</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: php; title: ; notranslate" title="">
/**
 * Updates a product.
 *
 * @param Product $product Product object.
 */
public function update( &amp;$product ) {
    $product_id = $product-&gt;get_id();
    $changes    = $progressive_discount-&gt;get_changes();

    // Update post object.
	$post_data = array(
        'ID'                =&gt; $product_id,
        'post_title'        =&gt; $product-&gt;get_name(),
		'post_modified'     =&gt; current_time( 'mysql' ),
		'post_modified_gmt' =&gt; current_time( 'mysql', 1 ),
	);

    wp_update_post( $post_data );

    // Update post metas.
    foreach ( $changes as $prop =&gt; $value ) {
        if ( 'name' === $prop ) {
            continue;
        }

        // Sanitize value here.

        update_post_meta( $product_id, $prop, $value );
    }

    $product-&gt;apply_changes();
}
</pre></div>


<p>The update method is a bit more complex. We use the function <code>wp_update_post()</code> to update the product data in the “<strong>posts</strong>” table, including the “<strong>post_modified</strong>” columns.</p>



<p>Next, we update the post metadata, but only for the modified properties. And finally, we apply the changes to the product data.</p>



<p>And the last one, the <code>delete()</code> method:</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: php; title: ; notranslate" title="">
/**
 * Deletes a product.
 *
 * @param Product $product Product object.
 * @return bool
 */
public function delete( &amp;$product ) {
    $product_id = $product-&gt;get_id();

    if ( ! $product_id ) {
        return false;
    }

    wp_delete_post( $product_id, true );

    $product-&gt;set_id( 0 );

    return true;
}
</pre></div>


<p>This is the easiest method. First, it checks the product is not new (it has an ID), then uses the function <code>wp_delete_post()</code> to delete the object from the database, and finally, set the product ID to zero to reflect its new status.</p>



<h2>All together</h2>



<p>Now that our <strong>Product</strong> class has its own data store class, it’s time to do the final tweaks to make them work together.</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: php; title: ; notranslate" title="">
class Product extends Data {

    // Assume all the code implemented previously.

    /**
     * Constructor.
	 *
	 * @param int $product_id Optional. Product ID.
	 */
    public function __construct( $product_id = 0) {
        $this-&gt;data_store = new Product_Data_Store();

        if ( is_numeric( $product ) &amp;&amp; $product &gt; 0 ) {
            $this-&gt;set_id( $product_id );
            $this-&gt;data_store-&gt;read( $this );
        }
    }
}
</pre></div>


<p>The only missing functionality is the constructor, in which we initialize the <code>$data_store</code> property with an instance of <strong>Product_Data_Store</strong> and use its method <code>read()</code> for fetching the data from the database in case a product ID is provided.</p>



<p><strong>Note:</strong> I know the classes <strong>Product</strong> and <strong>Product_Data_Store</strong> are quite coupled at this moment, but this is just an example of implementation. You could inject the data store class as a dependency or use a different approach for decoupling them.</p>



<p>We are close to the end. Let’s see how it looks like our classes with all the code:</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: php; title: ; notranslate" title="">
abstract class Data {

    /**
	 * Object ID.
	 *
	 * @var int
	 */
    protected $id = 0;

    /**
	 * A reference to the data store.
	 *
	 * @var Data_Store
	 */
    protected $data_store;

    /**
	 * Object data in pairs (name + value).
	 *
	 * @var array
	 */
    protected $data = array();

    /**
	 * Data changes for this object.
	 *
	 * @var array
	 */
	protected $changes = array();


    /**
	 * Gets the object ID.
     *
     * @return int
     */
    public function get_id() {
        return $this-&gt;id;
    }

    /**
	 * Sets the object ID.
     *
     * @param int $id Object ID.
     */
    public function set_id( $id ) {
        $this-&gt;id = absint( $id );
    }
 
    /**
	 * Gets the value of the specified property.
     *
     * @param string $prop The property name.
     * @return mixed
     */
    protected function get_prop( $pop ) {
        $value = null;

        if ( array_key_exists( $prop, $this-&gt;data ) ) {
            $value = ( array_key_exists( $prop, $this-&gt;changes ) ? $this-&gt;changes[ $prop ] : $this-&gt;data[ $prop ] );
        }

        return $value;
    }
 
    /**
	 * Sets the value of the specified property.
     *
     * @param string $prop  The property name.
     * @param mixed  $value The value to set.
     */
    protected function set_prop( $prop, $value ) {
        if ( ! array_key_exists( $prop, $this-&gt;data ) ) {
            return;
        }

        if ( $value !== $this-&gt;data[ $prop ] || array_key_exists( $prop, $this-&gt;changes ) ) {
		    $this-&gt;changes[ $prop ] = $value;
	    }
    }

    /**
	 * Gets the data changes.
	 *
	 * @return array
	 */
	public function get_changes() {
		return $this-&gt;changes;
	}

    /**
	 * Merges changes with data and clear.
	 */
	public function apply_changes() {
		$this-&gt;data    = array_replace( $this-&gt;data, $this-&gt;changes ); // @codingStandardsIgnoreLine
		$this-&gt;changes = array();
	}

    /**
	 * Creates or updates the object.      
     *
     * @return int
     */
    public function save() {
        if ( ! $this-&gt;data_store ) {
            return $this-&gt;get_id();
        }

        if ( $this-&gt;get_id() ) {
		    $this-&gt;data_store-&gt;update( $this );
	    } else {
            $this-&gt;data_store-&gt;create( $this );
        }

        return $this-&gt;get_id();
    }

    /**
     * Deletes the object.
     *
     * @return bool
     */
    public function delete() {
        if ( ! $this-&gt;data_store ) {
            return false;
        }

        return $this-&gt;data_store-&gt;delete( $this );
    }
}
</pre></div>

<div class="wp-block-syntaxhighlighter-code "><pre class="brush: php; title: ; notranslate" title="">
class Product extends Data {

    /**
     * Product data.
     *
     * @var array
     */
    protected $data = array(
        'name'  =&gt; '',
        'price' =&gt; '',
    );


    /**
     * Constructor.
	 *
	 * @param int $product_id Optional. Product ID.
	 */
    public function __construct( $product_id = 0) {
        $this-&gt;data_store = new Product_Data_Store();

        if ( is_numeric( $product ) &amp;&amp; $product &gt; 0 ) {
            $this-&gt;set_id( $product_id );
            $this-&gt;data_store-&gt;read( $this );
        }
    }

    /**
     * Gets the product name.
	 *
	 * @return string
	 */
    public function get_name() {
        return $this-&gt;get_prop( 'name' );
    }

    /**
	 * Gets the product price.
	 *
	 * @return string
	 */
    public function get_price() {
        return $this-&gt;get_prop( 'price' );
    }

    /**
	 * Sets the product name.
	 *
	 * @param string $name Product name.
	 */
    public function set_name( $name ) {
        $this-&gt;set_prop( 'name', $name );
    }

    /**
	 * Sets the product price.
	 *
	 * @param string $price Product price.
	 */
    public function set_price( $price ) {
        $this-&gt;set_prop( 'price', floatval( $price ) );
    }
}
</pre></div>

<div class="wp-block-syntaxhighlighter-code "><pre class="brush: php; title: ; notranslate" title="">
class Product_Data_Store implements Data_Store {

    /**
	 * Creates a new product.
	 *
	 * @param Product $product Product object.
	 */
	 public function create( &amp;$product ) {
         $data = array(
             'post_type'    =&gt; 'product',
             'post_title'   =&gt; $product-&gt;get_name(),
             'post_content' =&gt; '',
         );

         $product_id = wp_insert_post( $data, true );

         if ( $product_id &amp;&amp; ! is_wp_error( $product_id ) ) {
             $product-&gt;set_id( $product_id );

             // Save the rest of properties as metadata.
             add_post_meta( $product_id, 'price', $product-&gt;get_price() );

             $product-&gt;apply_changes();
         }
     }

    /**
     * Reads a product.
     *
     * @param Product $product Product object.
     */
    public function read( &amp;$product ) {
        $product_id = $product-&gt;get_id();
        $post       = ( $product_id ? get_post( $product_id ) : null );

        if ( ! $post || 'product' !== $post-&gt;post_type ) {
            throw new Exception( 'Invalid product.' );
        }

        $product-&gt;set_name( $post-&gt;post_title );
        $product-&gt;set_price( get_post_meta( $post_id, 'price', true );
    }

    /**
     * Updates a product.
     *
     * @param Product $product Product object.
     */
    public function update( &amp;$product ) {
        $product_id = $product-&gt;get_id();
        $changes    = $progressive_discount-&gt;get_changes();

        // Update post object.
        $post_data = array(
            'ID'                =&gt; $product_id,
            'post_title'        =&gt; $product-&gt;get_name(),
		    'post_modified'     =&gt; current_time( 'mysql' ),
		    'post_modified_gmt' =&gt; current_time( 'mysql', 1 ),
        );

        wp_update_post( $post_data );

        // Update post metas.
        foreach ( $changes as $prop =&gt; $value ) {
            if ( 'name' === $prop ) {
                continue;
            }

            // Sanitize value here.

            update_post_meta( $product_id, $prop, $value );
        }

        $product-&gt;apply_changes();
    }

    /**
     * Deletes a product.
     *
     * @param Product $product Product object.
     * @return bool
     */
    public function delete( &amp;$product ) {
        $product_id = $product-&gt;get_id();

        if ( ! $product_id ) {
            return false;
        }

        wp_delete_post( $product_id, true );

        $product-&gt;set_id( 0 );

        return true;
    }
}
</pre></div>


<h2>In conclusion</h2>



<p>Today, we’ve seen a good example of how to handle the data of different objects thanks to the WooCommerce data and data store classes. Obviously, these classes are much more complex and they have more functionalities like better metadata management, data cache, etc., but I think our simplified version is a good starting point to understand how WooCommerce handles the object data and I hope this post helps you to dig into its code and unravel all its secrets, and who knows, to create your own Data class in your next project. That’s all for now, see you in the next post.</p>

		</div>

	</div>

	<div class="section-inner">
		
		<div class="post-meta-wrapper post-meta-single post-meta-single-bottom">

			<ul class="post-meta">

									<li class="post-tags meta-wrapper">
						<span class="meta-icon">
							<span class="screen-reader-text">Tags</span>
							<svg class="svg-icon" aria-hidden="true" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewbox="0 0 18 18"><path fill="" d="M15.4496399,8.42490555 L8.66109799,1.63636364 L1.63636364,1.63636364 L1.63636364,8.66081885 L8.42522727,15.44178 C8.57869221,15.5954158 8.78693789,15.6817418 9.00409091,15.6817418 C9.22124393,15.6817418 9.42948961,15.5954158 9.58327627,15.4414581 L15.4486339,9.57610048 C15.7651495,9.25692435 15.7649133,8.74206554 15.4496399,8.42490555 Z M16.6084423,10.7304545 L10.7406818,16.59822 C10.280287,17.0591273 9.65554997,17.3181054 9.00409091,17.3181054 C8.35263185,17.3181054 7.72789481,17.0591273 7.26815877,16.5988788 L0.239976954,9.57887876 C0.0863319284,9.4254126 0,9.21716044 0,9 L0,0.818181818 C0,0.366312477 0.366312477,0 0.818181818,0 L9,0 C9.21699531,0 9.42510306,0.0862010512 9.57854191,0.239639906 L16.6084423,7.26954545 C17.5601275,8.22691012 17.5601275,9.77308988 16.6084423,10.7304545 Z M5,6 C4.44771525,6 4,5.55228475 4,5 C4,4.44771525 4.44771525,4 5,4 C5.55228475,4 6,4.44771525 6,5 C6,5.55228475 5.55228475,6 5,6 Z"></path></svg>						</span>
						<span class="meta-text">
							<a href="https://juagonala.com/tag/data-stores/" rel="tag">data-stores</a>, <a href="https://juagonala.com/tag/wc-data/" rel="tag">wc-data</a>, <a href="https://juagonala.com/tag/woocommerce/" rel="tag">woocommerce</a>						</span>
					</li>
					
			</ul>

		</div>

		<div class="author-bio">
	<div class="author-title-wrapper">
		<div class="author-avatar vcard">
			<img alt="" src="https://secure.gravatar.com/avatar/9d8309dcc7988651d272e719ec2d86ba?s=160&d=mm&r=g" srcset="https://secure.gravatar.com/avatar/9d8309dcc7988651d272e719ec2d86ba?s=320&d=mm&r=g 2x" class="avatar avatar-160 photo" height="160" width="160" loading="lazy">		</div>
		<h2 class="author-title heading-size-4">
			By Juan José		</h2>
	</div>
	<div class="author-description">
		<p>Building amazing products for WordPress & WooCommerce since 2012.</p>
		<a class="author-link" href="#" rel="author">
			View Archive <span aria-hidden="true">→</span>		</a>
	</div>
</div>

	</div>

	
	<nav class="pagination-single section-inner" aria-label="Post">

		<hr class="styled-separator is-style-wide" aria-hidden="true">

		<div class="pagination-single-inner">

			
				<a class="previous-post" href="https://juagonala.com/stop-using-arrays-for-everything/">
					<span class="arrow" aria-hidden="true">←</span>
					<span class="title"><span class="title-inner">Stop using arrays for everything</span></span>
				</a>

				
				<a class="next-post" href="https://juagonala.com/what-a-developer-does/">
					<span class="arrow" aria-hidden="true">→</span>
						<span class="title"><span class="title-inner">What a developer does</span></span>
				</a>
				
		</div>

		<hr class="styled-separator is-style-wide" aria-hidden="true">

	</nav>

	
</article>

</main>


	<div class="footer-nav-widgets-wrapper header-footer-group">

		<div class="footer-inner section-inner">

							<div class="footer-top has-social-menu">
										
						<nav aria-label="Social links" class="footer-social-wrapper">

							<ul class="social-menu footer-social reset-list-style social-icons fill-children-current-color">

								<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-144"><a href="https://linkedin.com/in/juan-jose-gonzalez-alanis"><span class="screen-reader-text">LinkedIn</span><svg class="svg-icon" aria-hidden="true" role="img" focusable="false" width="24" height="24" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.7,3H4.3C3.582,3,3,3.582,3,4.3v15.4C3,20.418,3.582,21,4.3,21h15.4c0.718,0,1.3-0.582,1.3-1.3V4.3 C21,3.582,20.418,3,19.7,3z M8.339,18.338H5.667v-8.59h2.672V18.338z M7.004,8.574c-0.857,0-1.549-0.694-1.549-1.548 c0-0.855,0.691-1.548,1.549-1.548c0.854,0,1.547,0.694,1.547,1.548C8.551,7.881,7.858,8.574,7.004,8.574z M18.339,18.338h-2.669 v-4.177c0-0.996-0.017-2.278-1.387-2.278c-1.389,0-1.601,1.086-1.601,2.206v4.249h-2.667v-8.59h2.559v1.174h0.037 c0.356-0.675,1.227-1.387,2.526-1.387c2.703,0,3.203,1.779,3.203,4.092V18.338z"></path></svg></a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-143"><a href="https://github.com/juagonala"><span class="screen-reader-text">GitHub</span><svg class="svg-icon" aria-hidden="true" role="img" focusable="false" width="24" height="24" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12,2C6.477,2,2,6.477,2,12c0,4.419,2.865,8.166,6.839,9.489c0.5,0.09,0.682-0.218,0.682-0.484 c0-0.236-0.009-0.866-0.014-1.699c-2.782,0.602-3.369-1.34-3.369-1.34c-0.455-1.157-1.11-1.465-1.11-1.465 c-0.909-0.62,0.069-0.608,0.069-0.608c1.004,0.071,1.532,1.03,1.532,1.03c0.891,1.529,2.341,1.089,2.91,0.833 c0.091-0.647,0.349-1.086,0.635-1.337c-2.22-0.251-4.555-1.111-4.555-4.943c0-1.091,0.39-1.984,1.03-2.682 C6.546,8.54,6.202,7.524,6.746,6.148c0,0,0.84-0.269,2.75,1.025C10.295,6.95,11.15,6.84,12,6.836 c0.85,0.004,1.705,0.114,2.504,0.336c1.909-1.294,2.748-1.025,2.748-1.025c0.546,1.376,0.202,2.394,0.1,2.646 c0.64,0.699,1.026,1.591,1.026,2.682c0,3.841-2.337,4.687-4.565,4.935c0.359,0.307,0.679,0.917,0.679,1.852 c0,1.335-0.012,2.415-0.012,2.741c0,0.269,0.18,0.579,0.688,0.481C19.138,20.161,22,16.416,22,12C22,6.477,17.523,2,12,2z"></path></svg></a></li>

							</ul>

						</nav>

									</div>

			
			
		</div>

	</div>


			<footer id="site-footer" class="header-footer-group">

				<div class="section-inner">

					<div class="footer-credits">

						<p class="footer-copyright">©
							2022							<a href="https://juagonala.com/">Juan José González</a>
						</p>

						
						<p class="powered-by-wordpress">
							<a href="https://wordpress.org/">
								Powered by WordPress							</a>
						</p>

					</div>

					<a class="to-the-top" href="#site-header">
						<span class="to-the-top-long">
							To the top <span class="arrow" aria-hidden="true">↑</span>						</span>
						<span class="to-the-top-short">
							Up <span class="arrow" aria-hidden="true">↑</span>						</span>
					</a>

				</div>

			</footer>

		<script type="application/ld+json">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://juagonala.com/#website","url":"https://juagonala.com/","name":"Juan José González","potentialAction":{"@id":"https://juagonala.com/how-woocommerce-handles-object-data#searchaction"},"publisher":{"@id":"https://juagonala.com/#organization"}},{"@type":"SearchAction","@id":"https://juagonala.com/how-woocommerce-handles-object-data#searchaction","target":"https://juagonala.com/?s={search_term_string}","query-input":"required name=search_term_string"},{"@type":"BreadcrumbList","@id":"https://juagonala.com/how-woocommerce-handles-object-data#breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://juagonala.com/"},{"@type":"ListItem","position":2,"name":"Coding","item":"https://juagonala.com/category/coding/"}]},{"@type":"WebPage","@id":"https://juagonala.com/how-woocommerce-handles-object-data#webpage","url":"https://juagonala.com/how-woocommerce-handles-object-data","inLanguage":"en_US","name":"How WooCommerce handles object data","description":"Discover how WooCommerce decouples the data layer from the rest of the code in its different types of objects like products, orders, coupons, etc. by making use of the class WC_Data and the data store classes.","datePublished":"2021-09-24T21:00:28+00:00","dateModified":"2021-09-24T21:00:29+00:00","isPartOf":{"@id":"https://juagonala.com/#website"},"breadcrumb":{"@id":"https://juagonala.com/how-woocommerce-handles-object-data#breadcrumbs"}},{"@type":"Organization","@id":"https://juagonala.com/#organization","url":"https://juagonala.com/","name":"Juan José González"},{"@type":"Article","@id":"https://juagonala.com/how-woocommerce-handles-object-data#article","url":"https://juagonala.com/how-woocommerce-handles-object-data","headline":"How WooCommerce handles object data","datePublished":"2021-09-24T21:00:28+00:00","dateModified":"2021-09-24T21:00:29+00:00","wordCount":3121,"keywords":["data-stores","wc-data","woocommerce"],"articleSection":["Coding"],"isPartOf":{"@id":"https://juagonala.com/how-woocommerce-handles-object-data#webpage"},"mainEntityOfPage":{"@id":"https://juagonala.com/how-woocommerce-handles-object-data#webpage"},"publisher":{"@id":"https://juagonala.com/#organization"},"author":{"@id":"https://juagonala.com/how-woocommerce-handles-object-data#author"}},{"@type":"Person","@id":"https://juagonala.com/how-woocommerce-handles-object-data#author","url":"#","name":"Juan José","description":"Building amazing products for WordPress & WooCommerce since 2012.","givenName":"Juan José","familyName":"González Alanís","image":{"@id":"https://juagonala.com/how-woocommerce-handles-object-data#author_image"}},{"@type":"ImageObject","@id":"https://juagonala.com/how-woocommerce-handles-object-data#author_image","url":"https://secure.gravatar.com/avatar/9d8309dcc7988651d272e719ec2d86ba?s=96&d=mm&r=g","width":96,"height":96,"caption":"Juan José"}]}</script><script src="https://juagonala.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js" id="syntaxhighlighter-core-js"></script>
<script src="https://juagonala.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPhp.js" id="syntaxhighlighter-brush-php-js"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://juagonala.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.head.appendChild( corecss );
		var themecssurl = "https://juagonala.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeMidnight.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.head.appendChild( themecss );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.defaults['wrap-lines'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script>
	<script>
	/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1);
	</script>
	
	</body>
</html>
